
# 과정 1 | 문제 2
## 모빌리티 3팀 은대영
---
### 수행 목표
<br>

#### 최적의 하드웨어
| 마이크로컨트롤러|아키텍처|클럭 속도|플래시 메모리|특징|사용 보드|
| ----------------- | ------------------------------- | ------- | ------------------- | -------------------------------- | --------------------------------- |
| **ATmega328P**    | 8-bit AVR                       | 16 MHz  | 32 KB               | 저전력, 기본형                    | Arduino Uno, Nano                 |
| **ATmega4809**    | 8-bit AVR                       | 20 MHz  | 48 KB               | 향상된 GPIO, 고속처리              | Arduino Nano Every                |
| **SAMD21**        | 32-bit ARM Cortex-M0+           | 48 MHz  | 256 KB              | 저전력, USB 지원                   | Arduino Zero, MKR 시리즈            |
| **RP2040**        | 32-bit ARM Cortex-M0+ Dual-Core | 133 MHz | 264KB SRAM (외부 플래시) | 고성능, PIO 유닛 내장            | Arduino Nano RP2040 Connect       |
| **Renesas RA4M1** | 32-bit ARM Cortex-M4            | 48 MHz  | 256 KB              | 고속 ADC, CAN 지원                   | Arduino UNO R4 Minima/WiFi        |
| **ESP32**         | 32-bit Xtensa Dual-Core         | 240 MHz | 520KB SRAM (플래시 외장) | Wi-Fi, Bluetooth 내장, FreeRTOS 지원 | Arduino Nano ESP32, ESP32 Dev Kit |

<br>

#### 아두이노를 통한 220V 교류 전원 장비 제어

1. 릴레이 사용
    - 간단한 구조, 높은 전력 제어 가능
    - 기계식 접점: 수명 짧고 소음 발생
    - 회로 구성: 아두이노 - 트랜지스터 - 릴레이 - 220V 부하
    - 주의사항: 광절연 회로 또는 릴레이 모듈 사용 권장

<br>

2. SSR(Solid State Relay) 사용
    - 무소음, 반영구적, 고속 제어 가능
    - 발열, 비싼 가격대
    - 회로 구성: 아두이노 디지털 출력 - SSR - 220V 부하

<br>

3. TRIAC + Opto-Isolator
    - 정밀한 위상제어 가능, 밝기 및 속도 조절
    - 회로 복잡도 상승, 스위칭 타이밍 고려

<br>

#### 탑재 소프트웨어

- 아두이노 펌웨어 소프트웨어 특징
    <br>
    1. 단순성과 접근성
        - 초보자도 쉽게 하드웨어 제어 가능
        - Arduino IDE 통합 개발 환경 제공으로 코드 작성 후 컴파일, 업로드까지 원클릭 처리
        - 풍부한 하드웨어 추상화 라이브러리(GPIO, UART, PWM 등)
    <br>
    2. 실시간성 부재
        - 단일 스레드 기반 협력형 멀티태스킹(delay()함수 사용 시 전체 시스템 블로킹)
        - 인터럽트 처리 외에는 엄격한 데드라인 보장 불가
    <br>
    3. 하드웨어 제약
        - ATmega328P(2KB RAM)같은 저사양 MCU에서 동작 가능
        - 운영체제 없이 직접 하드웨어 제어

<br>

- RTOS 및 임베디드 리눅스와의 차이점
    - 아두이노 펌웨어 vs RTOS
        - 태스크 관리: 단일 루프 <-> 선점형/협력형 멀티태스킹 지원
        - 실시간성: 비결정적 지연 발생 가능 <-> 마이크로초 단위 데드라인 보장
        - 자원 사용: SRAM 2KB~8KB <-> 커널 크기 10KB ~ 50KB
        - 적용 분야: LED제어, 센서 모니터링 <-> 자동차 ECU, 의료기기, 산업 제어

<br>

- 아두이노 펌웨어 vs 임베디드 리눅스
    - 실행 환경: MCU 직접 제어 <-> MMU 탑재 SoC
    - 시스템 부팅: 수 ms 내 즉시 실행 <-> 수 초 ~ 수 분 소요
    - 기능 범위: 기본 I/O 제어 <-> 네트워크 스택, 파일 시스템, GUI 지원
    - 실시간성: 불가능 <-> PREEMPT_RT 패치 적용 시 지연

<br>

- 종합 비교
    - 아두이노 vs RTOS vs 임베디드 리눅스
    - 최소 램: 2KB <-> 10KB <-> 16MB
    - 태스크 우선순위: 미지원 <-> 32단계 이상 <-> 140단계
    - 개발 복잡도: 쉬움 <-> 보통 <-> 복잡

<br>

- 요약
    - 아두이노: 단순 제어/프로토타이핑에 적합
    - RTOS: 엄격한 실시간 요구사항이 있는 임베디드 시스템
    - 임베디드 리눅스: 복잡한 애플리케이션(네트워크/UI) 필요 시 사용

<br>

#### 저전력 시스템 및 경량화

<br>

- 아두이노 전력소비량 및 배터리 계산
    - Uno R3
        - 5V 16MHz, 소모전류 50mA
    - Nano
        - 5V 16MHz, 소모전류 20mA

<br>

- 배터리별 예상 구동 시간
    - CR2303 리튬 코인셀: Uno 4.7h, Nano 11.8h
    - Li-Po 523050: Uno 20h, Nano 50h
    - 18650 Li-ion: Uno 60h, Nano 150h

<br>

- 계산 식
    - 가동시간 = 배터리 용량(mAh) / 평균 전류(mA)

<br>

- 아두이노 기반 초걍령 임베디드 시스템
    - 5g 코인셀 노드: Pro mini 2g + CR2032 3g + 소형 온도센서 0.5g = 5g, 약 3달 사용가능

<br>

#### 아두이노 데이터 전송
- 센서 -> 아두이노 본체 -> 메모리 저장 또는 무선 전송
    - 온도 습도 센서나 가속도 센서같이 원하는 센서를 아두이노의 핀에 결합
    - 센서 라이브러리를 업로드하면 시리얼 모니터에서 모니터링 가능
    - 모은 값을 저장하기 위해서는 메모리 카드 사용
    - 기본 메모리는 저장 용량이 적어 설정 값 정도만 보관

<br>

- 모은 값을 바로 보내는 방법
    - USB 케이블, 블루투스, Wi-Fi

<br>

#### 시골마을 공원용 스마트 조명제어
- 태양광 패널 -> 충전 컨트롤러 -> 12V 배터리
- 12V 전원 -> 아두이노 + RTC 모듈
- 조도 센서, PIR 센서, LoRa 모듈, 릴레이 모듈
- LED 가로등 3~5개 

<br>

- MCU: 아두이노 미니 프로
- RTC: DS3231
- 조도 센서, 움직임 센서, 통신 센서 등

<br>

- 기본 로직: if(조도> 임계값) -> LED OFF
- 기본 밝기 30% (PWM), if(인체 감지) => 100% 밝기, 2분 후 30%
- 심야 절전: 사람 감지 시에만 짧게 50%
- LoRa 송신: 배터리 전압, 온도, 마지막 인체 감지 시각